## 说明

### 前端

- 预登录：
  1. 选项 1：用户输入邮箱，点击“获取验证码”，调用后端接口 sendEmailCode，后端服务向用户邮箱发送验证码。然后用户从邮箱获取验证码，在验证码框输入验证码调用后端接口 checkEmailCode 进行验证.
  2. 选项 2：调用 google 登录 api 完成登录（或更多其他网站）.
- 预登录完成后显示密码框，让用户输入 pin 码.
- 派生公钥与私钥
  1. 设定既定规则，根据已有的邮箱地址与用户名 pin 码，生成私钥。
  2. 根据私钥生成公钥（也许是多余的）
- 根据私钥生成一次性离线签名
- 将离线签名发送给后端
- （当前省略）后端收取离线签名后返回给前端当前用户是否需要新建
- （当前省略）如果需要新建，则出现充值，提示用户充值，用于 gas 费。进入充值流程....
- 后端返回当前当前用户实际控制的合约账户地址
- 前端进入详情主页，根据合约账户地址查询账户资产(+gas 成本)并展示。
- 其他详情页也根据合约账户地址查询。当前详情功能应有：
  1. 资产明细
  2. 最近交易明细
- 交易功能，应当具备功能：
  1. 发起交易
  2. SWAP(ETH 主网，则集成 uniswap)

### 后端

- /sendEmailCode：接收请求，然后向用户邮箱发送随机验证码
- /checkEmailCode: 接收请求，验证验证码的正确性
- /permitUser: 访问系统主合约，根据离线签名判断是否是新用户。新用户返回 0，老用户返回用户合约地址+gas 成本
- /permitRegister: 访问系统主合约，根据离线签名创建用户合约。
- 备注，创建合约及其他交易时，查询 chainlink 服务，将 gas 的 ETH 成本转换成 USDC，在系统主合约内记录用户的 gas 成本。目前，系统只记录，无需用户支付。
- /permitTransfer: 接收前端的交易请求，访问系统主合约，代替用户发起资产转出交易（ETH+ERC20）
- /permitTransferNFT: 接收前端的交易请求，访问系统主合约，代替用户发起 NFT 转出交易
- /permitApprove: 接收前端的交易请求，访问系统主合约，代替用户发 ERC20 的授权
- /permitApproveNFT: 接收前端的交易请求，访问系统主合约，代替用户发 NFT 的授权
- /permitApproveAllNFT: 接收前端的交易请求，访问系统主合约，代替用户发全部 NFT 的授权
- /permitMarketApprove: 接收前端的 的 market 的 allow 交易请求，访问系统主合约，代替用户向 market 发起授权交易.
- /permitMarketSWAP: 接收前端的 SWAP 交易请求，访问系统主合约，代替用户向 market 发起交易.
